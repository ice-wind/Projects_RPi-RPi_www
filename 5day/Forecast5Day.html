<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
	<title>Get_forecast_data</title>
	<link rel="stylesheet" type="text/css" href="css/5day.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/highcharts-more.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>
	<script src="http://code.highcharts.com/modules/solid-gauge.js"></script>
	<script type="text/javascript" src="js/5day.js"></script>
	<script type="text/javascript">
	var chart;
	$(document).ready(function () {
		function loadScript(url, callback)
		{
			// Adding the script tag to the head as suggested before
			var head = document.getElementsByTagName('head')[0];
			var script = document.createElement('script');
			script.type = 'text/javascript';
			script.src = url;

			// Then bind the event to the callback function.
			// There are several events for cross browser compatibility.
			script.onreadystatechange = callback;
			script.onload = callback;

			// Fire the loading
			head.appendChild(script);
		}

		loadJSON(function(data){

			main_options.series= [{
						
						name: 'Temp',
						type: 'spline',
						yAxis: 0,
						data: (function(){
								var temp_in_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Temperature,w_desc:field.Weather_description,w_icon:field.Weather_icon,w_main:field.Weather_main,humidity:field.Humidity,pressure:field.Pressure};
									temp_in_data.push(i);
								});
								console.log(temp_in_data);
							return temp_in_data;
						})(),
						dataLabels:{
								enabled:true,
								useHTML:true,
								formatter:function(){
									 return '<span>'+this.point.w_icon+'</span><br/><br />';
									//return '<img src="http://highcharts.com/demo/gfx/sun.png"><img>&nbsp;';
								}
							},
						color: '#FF3D8B',
						negativeColor: '#CCFFFF',
						tooltip:{
							enabled:true,
						},
						zIndex:100
					},{
						name:'Hum',
						type: 'areaspline',
						yAxis: 1,
						data: (function(){
								var hum_in_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Humidity};
									hum_in_data.push(i);
								});
								console.log(hum_in_data);
							return hum_in_data;
						})(),
						enableMouseTracking: false,
						tooltip:{
							enabled:false
						},
						dashStyle: 'shortdashdot',
						color:'#D1F6FF',
						marker:{
							enabled: false,
							symbol: 'circle',
							radius: 1,
							states:{
								hover:{
									enabled:true
								}
							}
						}
					},{
						name: 'Rain-Fall',
						type: 'column',
						yAxis:2,
						data: (function(){
								var rain_in_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Rain};
									rain_in_data.push(i);
								});
								console.log(rain_in_data);
							return rain_in_data;
						})(),
						enableMouseTracking: false,
						color:'blue',

					},{
						name: 'Snow-Fall',
						type: 'column',
						yAxis:2,
						data: (function(){
								var snow_in_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Rain};
									snow_in_data.push(i);
								});
								console.log(snow_in_data);
							return snow_in_data;
						})(),
						enableMouseTracking: false,
						color:'grey',
						plotOptions: {
							series: {
								pointWidth: 400
							}
						},
						
						
					},
					{
						name: 'clouds',
						type: 'arearange',
						yAxis:3,
						data: (function(){
								var clouds_in_data = [];
								$.each(data,function(i,field){							
									var i =[];
									console.log(field.Temperature);
									i.push(field.time);
									i.push(field.Humidity);
									i.push(-field.Humidity);
									//i={x:field.time,y:field.Humidity,y2:field.Rain};
									clouds_in_data.push(i);
								});
								console.log("clouds:");
								console.log(clouds_in_data);
							return clouds_in_data;
						})(),
						enableMouseTracking: false,

						fillColor : {
						  linearGradient: { x1: 0, x2: 0, y1: 0, y2: 1 },
							  stops: [[0, 'rgba(255, 255, 255,0)'], [0.7, 'rgba(99, 99, 99,0.3)'],[1, 'rgba(0, 0, 0,1)']]
						},
						lineWidth:0,
					}]
//----------------------------------------DEFINITION CHART WIND--------------------------------							
			options_windSpeed.series = [{
						name: 'WindSpeed',
						type: 'spline',
						tickInterval: 24 * 3600 * 1000,
						yAxis: 0,
						data: (function(){
								var sealevel_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Sea_level};
									sealevel_data.push(i);
								});
								console.log(sealevel_data);
								console.log("array:");
							return sealevel_data;
						})(),
						enableMouseTracking: true
					},{
						name: 'WindSpeed Icon',
						type: 'spline',
						yAxis: 1,
						tickInterval: 24 * 3600 * 1000,
						data: (function(){
								var sealevel_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:0};
									sealevel_data.push(i);
								});
								console.log(sealevel_data);
							return sealevel_data;
						})(),
						enableMouseTracking: false,
						dataLabels:{
								enabled:true,
								useHTML:true,
								y:245,
								formatter:function(){
									 return '<img src="img/wind_arrow.png" width="20px" height="20px" style= " float:left; transform: rotate(45deg) scale(1);-ms-transform: rotate(45deg) scale(1); -webkit-transform:rotate(45deg) scale(1);" />';
								}
							}
					}]
			options_windSpeed.xAxis = [{
										
										},{
										offset:-280,
										tickInterval: 24 * 3600 * 1000,
										
										}]

//----------------------------------------DEFINITION CHART PRESSURE--------------------------------			
			options_pressure.series= [{
						name: 'Pressure',
						type: 'spline',
						yAxis: 0,
						data: (function(){
								var pressure_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Pressure};
									pressure_data.push(i);
								});
								console.log(pressure_data);
							return pressure_data;
						})(),
						color: '#6C3738',
						tooltip:{
							valueSuffix: 'Pa',
						},
						dashStyle: 'longdash'
					},
					{
						name: 'Altitude',
						type: 'spline',
						yAxis: 1,
						data: (function(){
								var sealevel_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Sea_level};
									sealevel_data.push(i);
								});
								console.log(sealevel_data);
							return sealevel_data;
						})(),
						enableMouseTracking: true,
						color: '#EA8D11',
						tooltip:{
							valueSuffix: 'Pa',
						}
					}]
					
			
//----------------------------------------DEFINITION CHART SEA LEVEL--------------------------------							
			options_sealevel.series = [{
						name: 'Sea_level',
						type: 'spline',
						yAxis: 0,
						data: (function(){
								var sealevel_data = [];
								$.each(data,function(i,field){							
									var i ={};
									i={x:field.time,y:field.Sea_level};
									sealevel_data.push(i);
								});
								console.log(sealevel_data);
							return sealevel_data;
						})(),
						enableMouseTracking: true,
						color: '#EA8D11',
						tooltip:{
							valueSuffix: 'Pa',
						}
					}]	

//---------------------------------------GAUGE OPTIONS--------------------------------------------------
	gaugeOptions_tempIn.series= [{
				name: 'Temp in',
				data: 
						(function(){		
								var temp_in_data = [data[data.length-1].Temp_in];
							return temp_in_data;
						})(),
				dataLabels: {
					useHTML: true,
					format: '<img src="img/Hum.png" width="50px" align="center"><div style="Width: 50px;text-align:center"><span style="font-size:30px;color:#009933">{y}</span></div>'
				}
			}]

	gaugeOptions_tempOut.series= [{
						name: 'Temp out',
						data: 
								(function(){		
										var temp_out_data = [data[data.length-1].Temp_out];
									return temp_out_data;
								})(),
						dataLabels: {
							format: '<div style="Width: 50px;text-align:center"><span style="font-size:30px;color:purple">{y}</span></div>'
						}
					}]
					
	gaugeOptions_humidity.series= [{
						name: 'Humidity',
						data: 
								(function(){		
										var humidity_data = [data[data.length-1].Humidity];
									return humidity_data;
								})(),
						dataLabels: {
						
							format: '<div style="Width: 50px;text-align:center"><span style="font-size:30px;color:#009ce8">{y}</span></div>'
						}
					}]
					
	gaugeOptions_pressure.series= [{
						name: 'Pressure',
						data: 
								(function(){		
										var pressure_data = [data[data.length-1].Pressure];
									return pressure_data;
								})(),
						dataLabels: {
							format: '<div style="Width: 50px;text-align:center"><span style="font-size:30px;color:orange">{y}</span></div>'
						}
					}]

//--------------------------------------CREATE GAUGE----------------------------------------------------
				
				gaugeOptions_humidity = jQuery.extend(true,[],defaultGaugeOptions,gaugeOptions_humidity);
				var gauge3 = new Highcharts.Chart(gaugeOptions_humidity);
				gaugeOptions_pressure = jQuery.extend(true,[],defaultGaugeOptions,gaugeOptions_pressure);
				var gauge4 = new Highcharts.Chart(gaugeOptions_pressure);		
				
//-------------------------------round corner in gauge-----------------------------------------							
$(document).ready(function () {
				var svg;
					svg = document.getElementsByTagName('svg');
					if (svg.length > 0) {
						$.each(svg,function(i,field){
							var path = field.getElementsByTagName('path')
								if (path.length > 1) {
									console.log(path);
									// First path is gauge background
									path[0].setAttributeNS(null, 'stroke-linejoin', 'round');
									// Second path is gauge value
									path[1].setAttributeNS(null, 'stroke-linejoin', 'round');
									path[2].setAttributeNS(null, 'stroke-linejoin', 'round');
							}
						})
						
					}
		});
//-------------------------------end round corner----------------------------------------
//----------------------------------CREATE CHARTS---------------------------------------------
					
					chart = new Highcharts.Chart(main_options);
					chart_options_sealevel = new Highcharts.Chart(options_windSpeed);
					chart_2graph_pressure = new Highcharts.Chart(options_pressure);
					chart_options_sealevel = new Highcharts.Chart(options_sealevel);
			});

	});
	
	
	
	</script>

</head>
<body>
Start
	<div id='container'>h</div>
	<div id='graph_windSpeed'>h</div>
	<div id='2graph_pressure'>h</div>
	<div id='3graph_sealevel'>h</div>
	

	<div id='3gauge'></div>
	<div id='4gauge'></div>
</body>
</html>